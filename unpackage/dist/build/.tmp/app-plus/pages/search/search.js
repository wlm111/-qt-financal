(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{1399:function(t,e,n){"use strict";n.r(e);var i=n("bfc5"),r=n("d6f6");for(var u in r)"default"!==u&&function(t){n.d(e,t,function(){return r[t]})}(u);var a,o=n("f0c5"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=s.exports},"7c57":function(t,e,n){"use strict";(function(t){n("1133"),n("921b");i(n("66fd"));var e=i(n("1399"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},bfc5:function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement;t._self._c},u=[];n.d(e,"b",function(){return r}),n.d(e,"c",function(){return u}),n.d(e,"a",function(){return i})},d6f6:function(t,e,n){"use strict";n.r(e);var i=n("d771"),r=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,function(){return i[t]})}(u);e["default"]=r.a},d771:function(t,e,n){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=u(n("a34a"));function u(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return c(t)||s(t,e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(t,e){var n=[],i=!0,r=!1,u=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done);i=!0)if(n.push(a.value),e&&n.length===e)break}catch(s){r=!0,u=s}finally{try{i||null==o["return"]||o["return"]()}finally{if(r)throw u}}return n}function c(t){if(Array.isArray(t))return t}function d(t,e,n,i,r,u,a){try{var o=t[u](a),s=o.value}catch(c){return void n(c)}o.done?e(s):Promise.resolve(s).then(i,r)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var u=t.apply(e,n);function a(t){d(u,i,r,a,o,"next",t)}function o(t){d(u,i,r,a,o,"throw",t)}a(void 0)})}}var f=function(){return n.e("components/index/index-list").then(n.bind(null,"3661"))},l=function(){return n.e("components/common/no-thing").then(n.bind(null,"d4b7"))},p=function(){return n.e("components/common/load-more").then(n.bind(null,"f349"))},m=function(){return n.e("components/news/topic-list").then(n.bind(null,"ee8d"))},g=function(){return n.e("components/user-list/user-list").then(n.bind(null,"dc0c"))},v={components:{indexList:f,noThing:l,loadMore:p,topicList:m,userList:g},data:function(){return{issearch:!1,loadtext:"上拉加载更多",list:[],searchtext:"",page:1,searchType:"post"}},onNavigationBarButtonTap:function(e){0==e.index&&t.navigateBack({delta:1})},onNavigationBarSearchInputChanged:function(t){this.searchtext=t.text},onNavigationBarSearchInputConfirmed:function(t){t.text&&this.getdata()},onReachBottom:function(){this.loadmore()},onPullDownRefresh:function(){this.getdata(),t.stopPullDownRefresh()},computed:{getPlaceholder:function(){var t="文章";return"post"==this.searchType?t="文章":"topic"==this.searchType?t="话题":"user"==this.searchType&&(t="用户"),"搜索"+t}},onLoad:function(e){if(e){this.searchType=e.searchType||"post";var n="搜索文章";"topic"==this.searchType?n="搜索话题":"user"==this.searchType&&(n="搜索用户");var i=this.$mp.page.$getAppWebview(),r=i.getStyle().titleNView;r.searchInput.placeholder=n,i.setStyle({titleNView:r}),t.$on("updateData",this.updateData)}},methods:{updateData:function(t){switch(t.type){case"guanzhu":this.updateGuanZhu(t);break;case"support":this.updateSupport(t);break;case"updateComment":this.updateComment(t);break}},updateComment:function(t){var e=this.list.find(function(e){return e.id===t.post_id});e&&e.commentnum++},updateSupport:function(t){var e=this.list.find(function(e){return e.id===t.post_id});if(e){var n=e.infonum.index;e.infonum.index="ding"==t.do?1:2,0!==n&&(1==n?e.infonum.dingnum--:e.infonum.cainum--),0!==e.infonum.index&&(1==e.infonum.index?e.infonum.dingnum++:e.infonum.cainum++)}},updateGuanZhu:function(t){this.list.forEach(function(e,n){e.userid===t.userid&&(e.isguanzhu=t.data)})},getdata:function(){var e=h(r.default.mark(function e(){var n,u,o,s,c,d,h,f,l,p=this;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"Loading..."}),n="/search/"+this.searchType,e.next=4,this.$http.post(n,{keyword:this.searchtext,page:this.page},{token:!0});case 4:if(u=e.sent,o=a(u,2),s=o[0],c=o[1],d=this.$http.errorCheck(s,c,function(){t.hideLoading(),p.issearch=!0},function(){t.hideLoading(),p.issearch=!0}),d){e.next=11;break}return e.abrupt("return");case 11:for(h=[],f=c.data.data.list,console.log(i(c," at pages\\search\\search.vue:205")),l=0;l<f.length;l++)h.push(this.__format(f[l]));this.list=this.page>1?this.list.concat(h):h,this.issearch=!0,this.loadtext=f.length<10?"没有更多数据了":"上拉加载更多",t.hideLoading();case 19:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),loadmore:function(){"上拉加载更多"==this.loadtext&&(this.loadtext="加载中...",this.page++,this.getdata())},__format:function(t){switch(this.searchType){case"post":return{userid:t.user.id,userpic:t.user.userpic,username:t.user.username,isguanzhu:!!t.user.fens.length,id:t.id,title:t.title,type:"img",titlepic:t.titlepic,video:!1,path:t.path,share:!!t.share,infonum:{index:t.support.length>0?t.support[0].type+1:0,dingnum:t.ding_count,cainum:t.cai_count},commentnum:t.comment_count,sharenum:t.sharenum,sex:t.user.userinfo.sex,age:t.user.userinfo.age};case"topic":return{id:t.id,titlepic:t.titlepic,title:t.title,desc:t.desc,totalnum:t.post_count,todaynum:t.todaypost_count};case"user":return{id:t.id,userpic:t.userpic,username:t.username,age:t.userinfo.age,sex:t.userinfo.sex,isguanzhu:!1}}}}};e.default=v}).call(this,n("6e42")["default"],n("0de9")["default"])}},[["7c57","common/runtime","common/vendor"]]]);